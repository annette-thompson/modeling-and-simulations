%% set_vars
function S = set_vars()
% Assigns all variables needed to calculate parameters
%   Output: 
%       S: structure storing all variables

% Set up structure to store variables
S = struct;

% Optimized parameters vector
% p_vec = [a1 a2 a3 b1 c2 c3 c1 b2 b3 d1 d2 e f c4 x1 x2 x3 x4];
S.p_vec = [142473.7238 7597.676912 4.276689943 40213.92919 88.88525384 0.005388274...
    4.645634978 0.006677519 0.284982219 -0.285700283 3.348915642 2.886607673 132.8499358...
    2180.050007 0.539756276	0.053673263	34.49718991	11.15058888];

% Potential FA lengths for calculating production profile
% Numbers repeated are saturated and unsaturated
S.FA_dist = [4,6,8,10,12,14,16,18,20,12,14,16,18,20];

% Species labels
S.labels = {'ATP', 'C1_Bicarbonate', 'C2_AcCoA', 'C4_SucCoA', 'C6_HexCoA', 'C8_OcCoA', 'C10_DecCoA', 'C12_LauCoA', 'C14_EthCoA', 'C16_PalCoA', 'C18_OcDecCoA',...
    'ACP', 'NADPH', 'NADP', 'NADH', 'NAD', 'ADP','C3_MalCoA', 'CoA', 'C3_MalACP', 'C1_CO2', 'C4_BKeACP', 'C6_BKeACP', 'C8_BKeACP', 'C10_BKeACP',...
    'C12_BKeACP', 'C14_BKeACP', 'C16_BKeACP', 'C18_BKeACP','C20_BKeACP', 'C12_BKeACP_un', 'C14_BKeACP_un', 'C16_BKeACP_un', 'C18_BKeACP_un',...
    'C20_BKeACP_un', 'C4_BHyAcACP', 'C6_BHyAcACP', 'C8_BHyAcACP', 'C10_BHyAcACP', 'C12_BHyAcACP', 'C14_BHyAcACP', 'C16_BHyAcACP', 'C18_BHyAcACP',...
    'C20_BHyAcACP', 'C12_BHyAcACP_un', 'C14_BHyAcACP_un', 'C16_BHyAcACP_un', 'C18_BHyAcACP_un', 'C20_BHyAcACP_un', 'C4_EnAcACP', 'C6_EnAcACP',...
    'C8_EnAcACP', 'C10_EnAcACP', 'C12_EnAcACP', 'C14_EnAcACP', 'C16_EnAcACP', 'C18_EnAcACP', 'C20_EnAcACP', 'C10_cis3EnAcACP', 'C12_EnAcACP_un',...
    'C14_EnAcACP_un', 'C16_EnAcACP_un', 'C18_EnAcACP_un', 'C20_EnAcACP_un', 'C4_AcACP', 'C6_AcACP', 'C8_AcACP', 'C10_AcACP', 'C12_AcACP', 'C14_AcACP',...
    'C16_AcACP', 'C18_AcACP', 'C20_AcACP', 'C12_AcACP_un', 'C14_AcACP_un', 'C16_AcACP_un', 'C18_AcACP_un', 'C20_AcACP_un', 'C4_FA', 'C6_FA', 'C8_FA',...
    'C10_FA', 'C12_FA', 'C14_FA', 'C16_FA', 'C18_FA', 'C20_FA', 'C12_FA_un', 'C14_FA_un', 'C16_FA_un', 'C18_FA_un', 'C20_FA_un', 'BC_ATP', 'C1_BC_ATP_HCO3',...
    'C1_BC_Pi_HCO3', 'C1_BC_Pi_HCO3_BCCP_Biotin', 'C1_BCCP_Biotin_CO2', 'C1_CT_BCCP_Biotin_CO2', 'C1_CT_Act', 'C3_CT_Act_AcCoA', 'C3_FabD_MalCoA',...
    'C3_FabD_Act', 'C3_FabD_Act_ACP', 'C2_FabH_CoA', 'C4_FabH_CoA', 'C6_FabH_CoA', 'C8_FabH_CoA', 'C10_FabH_CoA', 'C12_FabH_CoA', 'C14_FabH_CoA',...
    'C16_FabH_CoA', 'C18_FabH_CoA', 'C2_FabH_Act', 'C4_FabH_Act', 'C6_FabH_Act', 'C8_FabH_Act', 'C10_FabH_Act', 'C12_FabH_Act', 'C14_FabH_Act',...
    'C16_FabH_Act', 'C18_FabH_Act', 'C5_FabH_Act_MalACP', 'C7_FabH_Act_MalACP', 'C9_FabH_Act_MalACP', 'C11_FabH_Act_MalACP', 'C13_FabH_Act_MalACP',...
    'C15_FabH_Act_MalACP', 'C17_FabH_Act_MalACP', 'C19_FabH_Act_MalACP', 'C21_FabH_Act_MalACP', 'FabG_NADPH', 'C4_FabG_NADPH_BKeACP',...
    'C6_FabG_NADPH_BKeACP', 'C8_FabG_NADPH_BKeACP', 'C10_FabG_NADPH_BKeACP', 'C12_FabG_NADPH_BKeACP', 'C14_FabG_NADPH_BKeACP',...
    'C16_FabG_NADPH_BKeACP', 'C18_FabG_NADPH_BKeACP', 'C20_FabG_NADPH_BKeACP', 'C12_FabG_NADPH_BKeACP_un', 'C14_FabG_NADPH_BKeACP_un',...
    'C16_FabG_NADPH_BKeACP_un', 'C18_FabG_NADPH_BKeACP_un', 'C20_FabG_NADPH_BKeACP_un', 'C4_FabZ_BHyAcACP', 'C6_FabZ_BHyAcACP',...
    'C8_FabZ_BHyAcACP', 'C10_FabZ_BHyAcACP', 'C12_FabZ_BHyAcACP', 'C14_FabZ_BHyAcACP', 'C16_FabZ_BHyAcACP', 'C18_FabZ_BHyAcACP',...
    'C20_FabZ_BHyAcACP', 'C12_FabZ_BHyAcACP_un', 'C14_FabZ_BHyAcACP_un', 'C16_FabZ_BHyAcACP_un', 'C18_FabZ_BHyAcACP_un', 'C20_FabZ_BHyAcACP_un',...
    'C4_FabZ_EnAcACP', 'C6_FabZ_EnAcACP', 'C8_FabZ_EnAcACP', 'C10_FabZ_EnAcACP', 'C12_FabZ_EnAcACP', 'C14_FabZ_EnAcACP', 'C16_FabZ_EnAcACP',...
    'C18_FabZ_EnAcACP', 'C20_FabZ_EnAcACP', 'C12_FabZ_EnAcACP_un', 'C14_FabZ_EnAcACP_un', 'C16_FabZ_EnAcACP_un', 'C18_FabZ_EnAcACP_un',...
    'C20_FabZ_EnAcACP_un', 'C4_FabA_BHyAcACP', 'C6_FabA_BHyAcACP', 'C8_FabA_BHyAcACP', 'C10_FabA_BHyAcACP', 'C12_FabA_BHyAcACP',...
    'C14_FabA_BHyAcACP', 'C16_FabA_BHyAcACP', 'C18_FabA_BHyAcACP', 'C20_FabA_BHyAcACP', 'C12_FabA_BHyAcACP_un', 'C14_FabA_BHyAcACP_un',...
    'C16_FabA_BHyAcACP_un', 'C18_FabA_BHyAcACP_un', 'C20_FabA_BHyAcACP_un', 'C4_FabA_EnAcACP', 'C6_FabA_EnAcACP', 'C8_FabA_EnAcACP', 'C10_FabA_EnAcACP',...
    'C12_FabA_EnAcACP', 'C14_FabA_EnAcACP', 'C16_FabA_EnAcACP', 'C18_FabA_EnAcACP', 'C20_FabA_EnAcACP', 'C10_FabA_cis3EnAcACP', 'C12_FabA_EnAcACP_un',...
    'C14_FabA_EnAcACP_un', 'C16_FabA_EnAcACP_un', 'C18_FabA_EnAcACP_un', 'C20_FabA_EnAcACP_un', 'FabI_NADH', 'C4_FabI_NADH_EnAcACP',...
    'C6_FabI_NADH_EnAcACP', 'C8_FabI_NADH_EnAcACP', 'C10_FabI_NADH_EnAcACP', 'C12_FabI_NADH_EnAcACP', 'C14_FabI_NADH_EnAcACP',...
    'C16_FabI_NADH_EnAcACP', 'C18_FabI_NADH_EnAcACP', 'C20_FabI_NADH_EnAcACP', 'C12_FabI_NADH_EnAcACP_un', 'C14_FabI_NADH_EnAcACP_un',...
    'C16_FabI_NADH_EnAcACP_un', 'C18_FabI_NADH_EnAcACP_un', 'C20_FabI_NADH_EnAcACP_un', 'C4_TesA_AcACP', 'C6_TesA_AcACP', 'C8_TesA_AcACP',...
    'C10_TesA_AcACP', 'C12_TesA_AcACP', 'C14_TesA_AcACP', 'C16_TesA_AcACP', 'C18_TesA_AcACP', 'C20_TesA_AcACP', 'C12_TesA_AcACP_un', 'C14_TesA_AcACP_un',...
    'C16_TesA_AcACP_un', 'C18_TesA_AcACP_un', 'C20_TesA_AcACP_un', 'C4_FabF_AcACP', 'C6_FabF_AcACP', 'C8_FabF_AcACP', 'C10_FabF_AcACP',...
    'C12_FabF_AcACP', 'C14_FabF_AcACP', 'C16_FabF_AcACP', 'C18_FabF_AcACP', 'C12_FabF_AcACP_un', 'C14_FabF_AcACP_un', 'C16_FabF_AcACP_un',...
    'C18_FabF_AcACP_un', 'C4_FabF_Act', 'C6_FabF_Act', 'C8_FabF_Act', 'C10_FabF_Act', 'C12_FabF_Act', 'C14_FabF_Act', 'C16_FabF_Act', 'C18_FabF_Act',...
    'C12_FabF_Act_un', 'C14_FabF_Act_un', 'C16_FabF_Act_un', 'C18_FabF_Act_un', 'C7_FabF_Act_MalACP', 'C9_FabF_Act_MalACP', 'C11_FabF_Act_MalACP',...
    'C13_FabF_Act_MalACP', 'C15_FabF_Act_MalACP', 'C17_FabF_Act_MalACP', 'C19_FabF_Act_MalACP', 'C21_FabF_Act_MalACP', 'C15_FabF_Act_MalACP_un',...
    'C17_FabF_Act_MalACP_un', 'C19_FabF_Act_MalACP_un', 'C21_FabF_Act_MalACP_un', 'C4_FabB_AcACP', 'C6_FabB_AcACP', 'C8_FabB_AcACP', 'C10_FabB_AcACP',...
    'C12_FabB_AcACP', 'C14_FabB_AcACP', 'C16_FabB_AcACP', 'C18_FabB_AcACP', 'C12_FabB_AcACP_un', 'C14_FabB_AcACP_un', 'C16_FabB_AcACP_un',...
    'C18_FabB_AcACP_un', 'C4_FabB_Act', 'C6_FabB_Act', 'C8_FabB_Act', 'C10_FabB_Act', 'C12_FabB_Act', 'C14_FabB_Act', 'C16_FabB_Act', 'C18_FabB_Act',...
    'C12_FabB_Act_un', 'C14_FabB_Act_un', 'C16_FabB_Act_un', 'C18_FabB_Act_un', 'C7_FabB_Act_MalACP', 'C9_FabB_Act_MalACP', 'C11_FabB_Act_MalACP',...
    'C13_FabB_Act_MalACP', 'C15_FabB_Act_MalACP', 'C17_FabB_Act_MalACP', 'C19_FabB_Act_MalACP', 'C21_FabB_Act_MalACP', 'C15_FabB_Act_MalACP_un',...
    'C17_FabB_Act_MalACP_un', 'C19_FabB_Act_MalACP_un', 'C21_FabB_Act_MalACP_un', 'C10_FabB_cis3EnAcACP', 'C10_FabB_Act_cis3', 'C13_FabB_Act_cis3MalACP',...
    'C4_FabH_AcACP', 'C6_FabH_AcACP', 'C8_FabH_AcACP', 'C10_FabH_AcACP', 'C12_FabH_AcACP', 'C14_FabH_AcACP', 'C16_FabH_AcACP', 'C18_FabH_AcACP',...
    'C20_FabH_AcACP', 'C12_FabH_AcACP_un', 'C14_FabH_AcACP_un', 'C16_FabH_AcACP_un', 'C18_FabH_AcACP_un', 'C20_FabH_AcACP_un', 'C6_FabH_Act_AcACP',...
    'C8_FabH_Act_AcACP', 'C10_FabH_Act_AcACP', 'C12_FabH_Act_AcACP', 'C14_FabH_Act_AcACP', 'C16_FabH_Act_AcACP', 'C18_FabH_Act_AcACP', 'C20_FabH_Act_AcACP',...
    'C22_FabH_Act_AcACP', 'C14_FabH_Act_AcACP_un', 'C16_FabH_Act_AcACP_un', 'C18_FabH_Act_AcACP_un', 'C20_FabH_Act_AcACP_un', 'C22_FabH_Act_AcACP_un',...
    'TesA_ACP', 'FabH_ACP', 'FabG_ACP', 'FabZ_ACP', 'FabI_ACP', 'FabF_ACP', 'FabA_ACP', 'FabB_ACP', 'C2_FabB_AcCoA', 'C2_FabB_Act', 'C5_FabB_Act_MalACP',...
    'C2_FabF_AcCoA', 'C2_FabF_Act', 'C5_FabF_Act_MalACP', 'C3_FabB_MalACP', 'C2_AcACP', 'C2_FabB_AcACP', 'C3_FabF_MalACP', 'C2_FabF_AcACP', 'C2_FabH_AcACP', 'C3_FabH_MalACP'};

S.num = length(S.labels); %how many diff eqs there are

% Set thioesterase fitting source
% 'Pf'; Pfleger group measurements
% 'R3M1';
% 'R3M4';
% 'Fox'; Fox group measurements
% 'Non-native'; For alternative thioesterases
S.TesA_fitting_source = 'Pf';

% Load parameter estimates
S.km_table = readtable('km_est.csv','ReadRowNames',true);
S.param_table = readtable('est_param.csv','ReadRowNames',true);
S.param_table_old = readtable('est_param_old.csv','ReadRowNames',true);

S.acp_bind = S.p_vec(12);%parameter "e"
S.ACP_inh = [S.acp_bind*2.41E-04,4.22*2.17E-02,2.41E-03,4.22*2.17E-02,2.41E-03,4.22*2.17E-02,2.41E-03,4.22*2.17E-02,2.41E-03,4.22*2.17E-02,S.acp_bind*2.41E-03,4.22*2.17E-02,2.41E-03,4.22*2.17E-02,2.41E-03,4.22*2.17E-02];%ACP_inh lists kon,koff (in this order) for inhibitory ACP binding[FabH,FabG,FabZ,FabI,TesA,FabF,FabA,FabB]
S.inhibition_kds = (1/S.acp_bind).*[4335.05,23.67;824.7,30.1;967.5,7.55;251.52,8.484;128.78,2.509];%(Acyl-ACP binding FabH Kd values in pairs (binding to FabH and FabH*), first two values are Kd for 4-12, subsequent values are 14-20)
S.inhibition_on_rates = [0.3088,1.552];%On rates of acyl-ACP binding FabH (binding to FabH and FabH*)
S.kd_fits = [S.p_vec(8),S.p_vec(9),S.p_vec(4)]; %["b2","b3","b1"] Keq or Kd values that are fit
S.lin_int = S.p_vec(11);%parameter "d2"
S.lin_slope = S.p_vec(10);%parameter "d1" TesA linear free energy slope and intercept (as a function of chain length)
S.num_elong_steps = 9;%number of elongation steps

S.scaling_factor_elon = S.p_vec(2);%parameter "a2"
S.scaling_factor_init = S.p_vec(1);%parameter "a1"
S.scaling_factor_kcat = S.p_vec(5);%parameter "c2"
S.scaling_factor_kcat_init = S.p_vec(7);%parameter "c1"
S.scaling_factor_kcat_term = S.p_vec(6);%parameter "c3"
S.scaling_factor_term = S.p_vec(3);%parameter "a3"

S.kcat_scaling_fabI = [1,1,1,1,1,1,1,1,1];
S.kcat_scaling_fabH = [1,0,0,0,0,0,0,0,0];
S.kon_scaling_fabH = [1,0,0,0,0,0,0,0,0];
S.kcat_scaling_fabG = [1,1,1,1,1,1,1,1,1];
S.kcat_scaling_fabA = [1,1,1,1,1,1,1,1,1];
S.kon_scaling_fabA = [0.0847,0.322,0.717,1,0.751,0.0847,0.0373,0.0373,0.0373];
S.scaling_factor_fabA_unsat = S.p_vec(13);%parameter "f"
S.kcat_scaling_fabA_unsat = [1,1,1,S.scaling_factor_fabA_unsat,1,1,1,1,1];
S.scaling_vector_fabA_unsat = [1,1,1,1,0.0358,0.0358,0.0358,0.0358,0.0358];%specificity of reaction with unsaturated acyl chains
S.scaling_factor_fabAZ_kcat = S.p_vec(14);%parameter "c4"
S.kcat_scaling_fabB = [0.855,0.855,0.975,0.967,1,0.125,0.0208,0.0208,.0208];
S.kcat_scaling_fabB_unsat = [1,1,1,1,1,0.125,0.0229,0.0229,0.0229];%specificity of reaction with unsaturated acyl chains
S.kcat_scaling_fabF = [0.914,0.914,0.901,1,0.9,0.289,0.0222,0.0222,0.0222];
S.kcat_scaling_fabF_unsat = [1,1,1,1,0.9,0.289,0.34,0.34,0.34];%specificity of reaction with unsaturated acyl chains
S.scaling_factor_fabF = S.p_vec(2);%parameter "a2" (option here to modify FabF scaling seperately)
S.kcat_scaling_fabZ = [1,1,1,1,1,1,1,1,1];
S.kon_scaling_fabZ = [0.469,1,0.296,0.372,0.2,0.0551,0.105,0.105,0.105];
S.scaling_factor_fabB_init = 1;
S.scaling_factor_fabF_init = 1;

S.scaling_factor_kcat8_CO2 = S.p_vec(15); % "x1"
S.scaling_factor_kcat10_CO2 = S.p_vec(16); % "x2"
S.scaling_factor_aCoA_8 = S.p_vec(17); % "x3"
S.scaling_factor_aCoA_10 = S.p_vec(18); % "x4"

S.Pf_kcat_scaling = [0.0568,0.0509,0.1035,0.0158,0.25256,0.45819,1,1.221,1.5368];
S.Pf_kd_est_scaling = [473 293.9 52.986 14.79];
S.Pf_scaling = 0.519*14.79;
S.Fox_kcat_scaling = [0.47895,0.47895,0.361111111,0.110185185,1.212962963,1.453703704,1.444444444,3.064814815,3.064814815];
S.Fox_kd_est_scaling = [4815.2 4815.2 434 48];
S.Fox_scaling = 1.0416*48;
S.Non_kcat_scaling = [0,0,0,0,0,0,1,1,1];
S.Non_kd_est = [1,1,1,1,1,1,1,1,1];
S.R3M1_kcat_scaling = [0.0568 0.0509 0.25256 0.0158 1.5368 0.45819 0.25256 1.221 1.5368];
S.R3M1_kd_est = [56.91208755 35.36250007 0.92358933 1.779555549 0.093940844 0.521582239 0.92358933 0.166345313 0.093940844];
S.R3M4_kcat_scaling = [0.0568 0.0509 1 0.0158 0.25256 0.45819 0.25256 1.221 1.5368];
S.R3M4_kd_est = [56.91208755 35.36250007 0.294555191 1.779555549 0.92358933 0.521582239 0.92358933 0.166345313 0.093940844];

% Comparison data with various combinations of FabH, FabF, FabB, and AcCoA 
S.opt_init_rate_data = [4.655129552 2.41772584 1.796165966 2.976304272 2.91667542 0.893110994 2.428676471];
% Excel Spreadsheet: 06172021 NADPH Assay No FabH, F, B and AcCoA Testing
S.opt_tot_prod_file = 'Experimental_Dataset.csv'; %Must have column titles Time(min) and Concentration(um) 
% (Yu, X.; Liu, T.; Zhu, F.; Khosla, C. Proceedings of the National Academy
% of Sciences 2011, 108, 18643-18648.)
S.opt_prod_dist_data = [0,0,0.059771046,0.011042448,0.202613717,0.075980144,0.29378989,0.07192787,0.143855739,0.117515956,0.002228751,0.02127444,0,0];
% (Grisewood, M.; Hernández-Lozada, N.; Thoden, J.; Gifford, N.; Mendez-Perez, 
% D.;Lai, R.; Holden, H.; Pfleger, Et. al. ACS Catalysis 2017, 7, 3837-3849.)